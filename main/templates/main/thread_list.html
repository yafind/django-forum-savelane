<!-- main/templates/main/thread_list.html -->
{% extends 'main/base.html' %}

{% block content %}
<div class="container py-4">
    {# Prefetch note: in view use `.prefetch_related('subsections')` to avoid N+1 queries #}
    <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="text-truncate">{{ subsection.title }}</h2>
    <a href="{% url 'new_thread' subsection.id %}" class="btn btn-sm btn-primary" aria-label="–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç–µ–º—É">–ù–æ–≤–∞—è —Ç–µ–º–∞</a>
</div>
<p class="text-muted">{{ subsection.description }}</p>

<!-- üîÅ –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
<div class="btn-group mb-3" role="group" aria-label="–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–µ–º">
    <a class="btn btn-outline-secondary {% if current_order == 'latest' %}active{% endif %}"
       href="?order=latest">
        –ù–æ–≤—ã–µ —Ç–µ–º—ã
    </a>
    <a class="btn btn-outline-secondary {% if current_order == 'active' %}active{% endif %}"
       href="?order=active">
        –ü–æ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –æ—Ç–≤–µ—Ç—É
    </a>
</div>

{% if threads %}
    <div class="list-group">
        {% for thread in threads %}
            <a href="{% url 'post_list' thread.id %}" class="list-group-item list-group-item-action">
                <div class="d-flex justify-content-between">
                    <strong class="text-truncate">{{ thread.title }}</strong>
                    <small class="text-muted"><time datetime="{{ thread.last_reply_at|date:'c' }}">{{ thread.last_reply_at|date:"d M Y H:i" }}</time></small>
                </div>
                <small class="text-muted">
                    <span>–ê–≤—Ç–æ—Ä: {{ thread.author.username }}</span>
                    <span class="mx-2">‚Ä¢</span>
                    <span>–û—Ç–≤–µ—Ç–æ–≤: {{ thread.posts.count }}</span>
                </small>
            </a>
        {% endfor %}
    </div>
{% else %}
    <p>–í —ç—Ç–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ –µ—â—ë –Ω–µ—Ç —Ç–µ–º. <a href="{% url 'new_thread' subsection.id %}">–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é?</a></p>
        {% endif %}
    </div>
</div>
{% endblock %}